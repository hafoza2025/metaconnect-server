<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø·ÙˆØ± | MetaConnect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #2563eb; --bg: #f8fafc; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); color: #1e293b; }

        /* Navbar & Cards */
        .navbar { background: #0f172a !important; padding: 1rem 0; }
        .card { border: none; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); transition: .3s; background: #fff; overflow: hidden; }
        .card:hover { transform: translateY(-3px); }
        .wallet-card { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }

        /* Auth Box */
        .auth-box { font-family: 'Outfit', monospace; background: #f1f5f9; padding: 4px 8px; border-radius: 4px; font-size: 0.9rem; color: #334155; border: 1px solid #e2e8f0; }

        /* Country Flags Backgrounds */
        .company-row { position: relative; transition: 0.3s; }
        .company-row.eg::before {
            content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px;
            background: linear-gradient(to bottom, #ce1126, #ffffff, #000000);
        }
        .company-row.sa::before {
            content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px;
            background: #006C35;
        }
        
        /* Flag Watermark in Modal */
        .modal-flag-bg {
            position: relative; overflow: hidden; z-index: 1;
        }
        .modal-flag-bg::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.15; background-size: cover; background-position: center;
        }
        .modal-flag-bg.eg::after { background-image: url('https://flagcdn.com/w640/eg.png'); }
        .modal-flag-bg.sa::after { background-image: url('https://flagcdn.com/w640/sa.png'); }

        /* Info Button Hover */
        .info-btn:hover { color: #2563eb; cursor: help; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#"><i class="bi bi-code-slash me-2"></i>MetaDev</a>
            <div class="d-flex gap-3 align-items-center">
                <span class="text-white-50 small d-none d-md-block">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <%= developer.name %></span>
                <a href="/logout" class="btn btn-outline-light btn-sm rounded-pill px-3">Ø®Ø±ÙˆØ¬</a>
            </div>
        </div>
    </nav>

    <div class="container py-5">
        
        <!-- Wallet & Add Company -->
        <div class="row g-4 mb-5">
            <div class="col-lg-4">
                <div class="card wallet-card h-100 p-4 text-center position-relative">
                    <i class="bi bi-wallet2 position-absolute top-0 end-0 m-3 fs-4 opacity-50"></i>
                    <h6 class="text-white-50 mb-1">Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©</h6>
                    <h2 class="fw-bold mb-3"><%= parseFloat(developer.wallet_balance).toFixed(2) %> <small class="fs-6">Ø¬.Ù…</small></h2>
                    <button class="btn btn-light w-100 rounded-pill fw-bold text-primary" onclick="alert('ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ø´Ø­Ù†')">Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯</button>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="card h-100 p-4">
                    <h5 class="fw-bold mb-3 text-primary"><i class="bi bi-plus-circle me-2"></i> ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h5>
                    <form action="/dev/add-company" method="POST" class="row g-3">
                        <div class="col-md-5"><input type="text" name="name" class="form-control" placeholder="Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠ" required></div>
                        <div class="col-md-4"><input type="text" name="tax_id" class="form-control" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ" required></div>
                        <div class="col-md-3">
                            <select name="country_code" class="form-select">
                                <option value="EG">Ù…ØµØ± ğŸ‡ªğŸ‡¬</option>
                                <option value="SA">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ğŸ‡¸ğŸ‡¦</option>
                            </select>
                        </div>
                        <div class="col-12 text-end"><button class="btn btn-primary px-4 rounded-pill">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button></div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Companies Table -->
        <div class="card shadow-sm">
            <div class="card-header bg-white py-3"><h5 class="m-0 fw-bold">Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h5></div>
            <div class="table-responsive">
                <table class="table align-middle mb-0">
                    <thead class="bg-light">
                        <tr><th class="ps-4">Ø§Ù„Ø´Ø±ÙƒØ©</th><th>Ø±ØµÙŠØ¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</th><th>Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</th><th width="28%">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</th><th class="text-center">ØªØ­ÙƒÙ…</th></tr>
                    </thead>
                    <tbody>
                        <% companies.forEach(function(comp) { 
                            // 1. Ø­Ø³Ø§Ø¨ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¯Ù‚ÙŠÙ‚
                            const pricePerInvoice = 0.5; // Ø³Ø¹Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø©
                            const freeInvoices = 20; // Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ
                            
                            // Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø§Ù„ÙŠ Ã· Ø§Ù„Ø³Ø¹Ø± = Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©
                            let paidInvoices = Math.floor((comp.allocated_balance || 0) / pricePerInvoice);
                            let totalLimit = freeInvoices + paidInvoices;
                            let remaining = totalLimit - (comp.invoices_used || 0);
                        %>
                            <tr class="company-row <%= comp.country_code.toLowerCase() %>">
                                <td class="ps-4">
                                    <div class="fw-bold"><%= comp.name %></div>
                                    <div class="small text-muted">
                                        <i class="bi bi-geo-alt"></i> <%= comp.country_code == 'EG' ? 'Ù…ØµØ±' : 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' %> 
                                        <span class="mx-1">|</span> <%= comp.tax_id %>
                                    </div>
                                </td>
                                <td>
                                    <% if(comp.allocated_balance > 0) { %>
                                        <span class="text-success fw-bold"><%= parseFloat(comp.allocated_balance).toFixed(2) %> Ø¬.Ù…</span>
                                    <% } else { %>
                                        <span class="text-muted small">0.00</span>
                                    <% } %>
                                </td>
                                <td>
                                    <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø¯Ù‚Ø© -->
                                    <% if(remaining > 0) { %>
                                        <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill px-3">
                                            <%= remaining %> ÙØ§ØªÙˆØ±Ø©
                                        </span>
                                        <div class="small text-muted mt-1" style="font-size: 0.7rem;">
                                            (Ù…Ø¬Ø§Ù†ÙŠ: <%= freeInvoices %> + Ù…Ø¯ÙÙˆØ¹: <%= paidInvoices %>)
                                        </div>
                                    <% } else { %>
                                        <span class="badge bg-danger">Ù†ÙØ¯ Ø§Ù„Ø±ØµÙŠØ¯</span>
                                    <% } %>
                                </td>
                                <td>
                                    <div class="bg-light p-2 rounded border d-flex justify-content-between align-items-center">
                                        <div>
                                            <div class="d-flex align-items-center gap-2 mb-1">
                                                <i class="bi bi-person text-secondary small"></i>
                                                <span class="auth-box" id="user-box-<%= comp.id %>">store_<%= comp.id %></span>
                                            </div>
                                            <div class="d-flex align-items-center gap-2">
                                                <i class="bi bi-key text-secondary small"></i>
                                                <span class="auth-box text-muted" id="pass-box-<%= comp.id %>">******</span>
                                            </div>
                                        </div>
                                        <button class="btn btn-sm btn-white shadow-sm text-primary" onclick="openAuthModal('<%= comp.id %>', '<%= comp.name %>')">
                                            <i class="bi bi-pencil-square"></i>
                                        </button>
                                    </div>
                                </td>
                                <td class="text-center">
                                    <button class="btn btn-success btn-sm rounded-pill px-3" onclick="openAlloc('<%= comp.id %>', '<%= comp.name %>')">ØªØ­ÙˆÙŠÙ„</button>
                                    <button class="btn btn-light btn-sm border rounded-circle" onclick="openCreds('<%= comp.id %>', '<%= comp.name %>', '<%= comp.country_code %>')">
                                        <i class="bi bi-gear-fill text-secondary"></i>
                                    </button>
                                </td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 1. Auth Modal (AJAX Real Update) -->
    <div class="modal fade" id="authModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0"><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body text-center pt-0">
                    <div class="bg-primary bg-opacity-10 p-3 rounded-circle d-inline-flex mb-3">
                        <i class="bi bi-shield-lock fs-1 text-primary"></i>
                    </div>
                    <h5 class="fw-bold mb-1" id="auth_comp_name"></h5>
                    <p class="text-muted small mb-4">ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</p>
                    
                    <form id="authForm" onsubmit="updateAuth(event)">
                        <input type="hidden" name="company_id" id="auth_comp_id">
                        <div class="form-floating mb-3 text-start">
                            <input type="text" name="new_username" id="new_user" class="form-control" required minlength="4">
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                        </div>
                        <div class="form-floating mb-4 text-start">
                            <input type="text" name="new_password" id="new_pass" class="form-control" required minlength="6">
                            <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 py-2 fw-bold rounded-pill">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 2. Creds Modal (With Flag BG & Help) -->
    <div class="modal fade" id="credsModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content overflow-hidden">
                <div class="modal-body p-0">
                    <div id="modalHeader" class="modal-flag-bg p-4 text-center">
                        <h4 class="fw-bold mb-0 position-relative z-2" id="credsTitle"></h4>
                        <span class="badge bg-white text-dark mt-2 position-relative z-2" id="credsComp"></span>
                    </div>
                    <form action="/dev/company/update-creds" method="POST" class="p-4">
                        <input type="hidden" name="company_id" id="creds_id">
                        <input type="hidden" name="country_code" id="creds_code">

                        <div id="eg_fields" style="display:none">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label class="fw-bold small">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© (ETA)</label>
                                <i class="bi bi-info-circle-fill text-primary info-btn" onclick="showHelp('EG')" title="Ø§Ø¶ØºØ· Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©"></i>
                            </div>
                            <input type="text" name="client_id" class="form-control mb-2" placeholder="Client ID">
                            <input type="text" name="client_secret" class="form-control mb-2" placeholder="Client Secret">
                        </div>

                        <div id="sa_fields" style="display:none">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label class="fw-bold small">Ø±Ù…Ø² Ø§Ù„ØªÙØ¹ÙŠÙ„ (ZATCA)</label>
                                <i class="bi bi-info-circle-fill text-success info-btn" onclick="showHelp('SA')" title="Ø§Ø¶ØºØ· Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©"></i>
                            </div>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="bi bi-shield-check"></i></span>
                                <input type="text" name="otp" class="form-control" placeholder="OTP (6 digits)">
                            </div>
                        </div>

                        <button class="btn btn-dark w-100 mt-4 fw-bold">Ø­ÙØ¸ Ø§Ù„Ø±Ø¨Ø·</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Help Modal (Dynamic Content) -->
    <div class="modal fade" id="helpModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title fw-bold">ÙƒÙŠÙÙŠØ© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <div id="helpContentEG" style="display:none">
                        <h6>ğŸ‡ªğŸ‡¬ Ù„Ù…ØµÙ„Ø­Ø© Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ø§Ù„Ù…ØµØ±ÙŠØ©:</h6>
                        <ol class="small text-muted">
                            <li>Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ù…ÙˆÙ„ (invoicing.eta.gov.eg).</li>
                            <li>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ "Ù…Ù„Ù Ø§Ù„Ø´Ø±ÙƒØ©" Ø«Ù… "ØªØ³Ø¬ÙŠÙ„ ERP".</li>
                            <li>Ø£Ù†Ø´Ø¦ Ù†Ø¸Ø§Ù… Ø¬Ø¯ÙŠØ¯ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ <b>Client ID</b> Ùˆ <b>Client Secret</b>.</li>
                        </ol>
                        <a href="https://invoicing.eta.gov.eg" target="_blank" class="btn btn-sm btn-outline-primary">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø¨ÙˆØ§Ø¨Ø©</a>
                    </div>
                    <div id="helpContentSA" style="display:none">
                        <h6>ğŸ‡¸ğŸ‡¦ Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© (ÙØ§ØªÙˆØ±Ø©):</h6>
                        <ol class="small text-muted">
                            <li>Ø§Ø¯Ø®Ù„ Ø¹Ù„Ù‰ Ø¨ÙˆØ§Ø¨Ø© "ÙØ§ØªÙˆØ±Ø©" (fatoora.zatca.gov.sa).</li>
                            <li>Ø§Ø®ØªØ± "ØªØ£Ù‡ÙŠÙ„ Ù†Ø¸Ø§Ù…" Ø«Ù… "Ø·Ù„Ø¨ Ø±Ù…Ø² OTP".</li>
                            <li>Ø³ÙŠØ¸Ù‡Ø± Ù„Ùƒ Ø±Ù…Ø² Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…ØŒ Ø§Ù†Ø³Ø®Ù‡ Ù‡Ù†Ø§.</li>
                        </ol>
                        <a href="https://fatoora.zatca.gov.sa" target="_blank" class="btn btn-sm btn-outline-success">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø¨ÙˆØ§Ø¨Ø©</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. Allocate Modal -->
    <div class="modal fade" id="allocModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <form action="/dev/allocate-balance" method="POST">
                    <div class="modal-body text-center p-4">
                        <h5 class="fw-bold mb-3">ØªØ®ØµÙŠØµ Ø±ØµÙŠØ¯</h5>
                        <input type="hidden" name="company_id" id="alloc_id">
                        <p class="text-muted" id="alloc_name"></p>
                        
                        <div class="bg-light p-3 rounded mb-3 border">
                            <small class="d-block text-muted">Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ</small>
                            <strong class="text-success fs-4"><%= parseFloat(developer.wallet_balance).toFixed(2) %></strong> <span class="small">Ø¬.Ù…</span>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="number" name="amount" class="form-control text-center fw-bold" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" required min="1" step="0.5">
                            <label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ­ÙˆÙŠÙ„Ù‡</label>
                        </div>
                        <button class="btn btn-success w-100 py-2 fw-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // --- 1. Auth Functions (AJAX) ---
        const authModal = new bootstrap.Modal(document.getElementById('authModal'));
        
        function openAuthModal(id, name) {
            document.getElementById('auth_comp_id').value = id;
            document.getElementById('auth_comp_name').innerText = name;
            // Get current value from UI
            document.getElementById('new_user').value = document.getElementById('user-box-'+id).innerText;
            authModal.show();
        }

        async function updateAuth(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            
            // Fake server delay for effect (Remove in production)
            const btn = e.target.querySelector('button');
            const originalText = btn.innerText;
            btn.innerText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
            btn.disabled = true;

            try {
                const response = await fetch('/dev/update-store-auth', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if(response.ok) {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹ (The Magic Fix)
                    document.getElementById(`user-box-${data.company_id}`).innerText = data.new_username;
                    document.getElementById(`pass-box-${data.company_id}`).innerText = data.new_password; // Optional: show actual pass
                    
                    authModal.hide();
                    alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ…');
                } else {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                }
            } catch (err) {
                console.error(err);
                alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„');
            }
            
            btn.innerText = originalText;
            btn.disabled = false;
        }

        // --- 2. Creds Functions ---
        const credsModal = new bootstrap.Modal(document.getElementById('credsModal'));
        const helpModal = new bootstrap.Modal(document.getElementById('helpModal'));

        function openCreds(id, name, code) {
            document.getElementById('creds_id').value = id;
            document.getElementById('creds_code').value = code;
            document.getElementById('credsComp').innerText = name;
            
            const header = document.getElementById('modalHeader');
            header.classList.remove('eg', 'sa');
            
            if(code === 'EG') {
                header.classList.add('eg');
                document.getElementById('credsTitle').innerText = 'Ù…ØµØ± (ETA)';
                document.getElementById('eg_fields').style.display = 'block';
                document.getElementById('sa_fields').style.display = 'none';
            } else {
                header.classList.add('sa');
                document.getElementById('credsTitle').innerText = 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© (ZATCA)';
                document.getElementById('eg_fields').style.display = 'none';
                document.getElementById('sa_fields').style.display = 'block';
            }
            credsModal.show();
        }

        function showHelp(country) {
            document.getElementById('helpContentEG').style.display = (country === 'EG') ? 'block' : 'none';
            document.getElementById('helpContentSA').style.display = (country === 'SA') ? 'block' : 'none';
            credsModal.hide(); // Hide main modal
            helpModal.show();  // Show help
            
            // When help is closed, re-open creds modal
            document.getElementById('helpModal').addEventListener('hidden.bs.modal', function () {
                credsModal.show();
            }, {once:true});
        }

        // --- 3. Alloc Functions ---
        function openAlloc(id, name) {
            document.getElementById('alloc_id').value = id;
            document.getElementById('alloc_name').innerText = name;
            new bootstrap.Modal(document.getElementById('allocModal')).show();
        }
    </script>
</body>
</html>
